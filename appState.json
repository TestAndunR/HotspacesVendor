{"EDITOR_STATE":{"allProjectFiles":{"dad2d1f5-2c20-4e8d-b5af-f23835e6dbb8":{"id":"dad2d1f5-2c20-4e8d-b5af-f23835e6dbb8","parent":null,"name":"HotspacesVendor","type":"DIRECTORY","isDirectory":true,"children":["48a4b4d6-c751-4efe-afe4-921eb254a535","c1737e82-f2d7-4d78-83b9-5332ec5c6efd"],"isRemovable":false,"filePath":"HotspacesVendor"},"48a4b4d6-c751-4efe-afe4-921eb254a535":{"id":"48a4b4d6-c751-4efe-afe4-921eb254a535","parent":"dad2d1f5-2c20-4e8d-b5af-f23835e6dbb8","name":"lambda.js","type":"LAMBDA_FILE","isDirectory":false,"children":[],"isRemovable":true,"filePath":"HotspacesVendor/lambda.js","code":"let AWS = require('aws-sdk');\nlet dynamoDBService = require('./dynamoDbService');\n\nexports.handler = function (event, context, callback) {\n    console.log(event);\n    let promoId = event.promoId;\n    let vendorId = event.vendorId;\n    let offerType = event.offerType;\n    let startDate = event.startDate;\n    let endDate = event.endDate;\n    let startTimeSlots = event.startTimeSlots;\n    let endTimeSlots = event.endTimeSlots;\n    let description = event.description;\n    let title = event.title;\n    let unitPrice = event.unitPrice;\n    let imgUrl = event.imgUrl;\n\n    dynamoDBService.addPromo({\n        promoId: promoId,\n        vendorId: vendorId,\n        offerType: offerType,\n        startDate: startDate,\n        endDate: endDate,\n        startTimeSlots: startTimeSlots,\n        endTimeSlots: endTimeSlots,\n        description: description,\n        title: title,\n        unitPrice: unitPrice,\n        imgUrl: imgUrl\n    }).promise().then(function () {\n        callback(null, {\n            \"isBase64Encoded\": true,\n            \"statusCode\": 200,\n            \"headers\": {\n                \"Access-Control-Allow-Origin\": \"*\",\n                \"Access-Control-Allow-Methods\": \"*\"\n            },\n            \"body\": 'Successfully added promotion : ' + title\n        });\n    }).catch(function (error) {\n        console.log(error);\n        callback(null, {\n            \"isBase64Encoded\": true,\n            \"statusCode\": 502,\n            \"headers\": {\n                \"Access-Control-Allow-Origin\": \"*\",\n                \"Access-Control-Allow-Methods\": \"*\"\n            },\n            \"body\": 'user could not add the promotion ' + error.message\n        });\n    });\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","triggers":[{"resourceName":"apigusEast1hotspacesVendorAddPromopost","config":{}}],"config":{"memory":128,"timeout":60,"runtime":"nodejs8.10"},"testCases":{"ace35fde-eba1-446d-b586-4954b6edfe94":{"id":"ace35fde-eba1-446d-b586-4954b6edfe94","name":"Unnamed event","functionId":"48a4b4d6-c751-4efe-afe4-921eb254a535","event":"{\n    \"key1\": \"value1\",\n    \"key2\": \"value2\",\n    \"key3\": \"value3\"\n}"}}},"c1737e82-f2d7-4d78-83b9-5332ec5c6efd":{"id":"c1737e82-f2d7-4d78-83b9-5332ec5c6efd","parent":"dad2d1f5-2c20-4e8d-b5af-f23835e6dbb8","name":"dynamoDbService.js","type":"JS_FILE","isDirectory":false,"children":[],"isRemovable":true,"filePath":"HotspacesVendor/dynamoDbService.js","code":"let AWS = require('aws-sdk');\nconst ddb = new AWS.DynamoDB.DocumentClient();\nconst uuidv4 = require('uuid/v4');\n\nmodule.exports = {\n  \n    addPromo: function (promoData) {\n        // let prmoId = uuidv4(); \n        let promoId = promoData.promoId;\n        let vendorId = promoData.vendorId;\n        let offerType = promoData.offerType;\n        let startDate = promoData.startDate;\n        let endDate = promoData.endDate;\n        let startTimeSlots = promoData.startTimeSlots;\n        let endTimeSlots = promoData.endTimeSlots;\n        let description = promoData.description;\n        let title = promoData.title;\n        let unitPrice = promoData.unitPrice;\n        let imgUrl = promoData.imgUrl;\n        return ddb.put({\n            TableName: 'HS_promotions',\n            Item: {\n                'PromoId': promoId,\n                'VendorId': vendorId,\n                'OfferType': offerType,\n                'StartDate': startDate,\n                'EndDate': endDate,\n                'StartTimeSlots': startTimeSlots,\n                'EndTimeSlots': endTimeSlots,\n                'Description': description,\n                'UnitPrice': unitPrice,\n                'Title': title,\n                'ImgUrl': imgUrl\n            }\n        });\n    },\n\n    \n}","triggers":[]}},"deletedFiles":[],"rootNode":"dad2d1f5-2c20-4e8d-b5af-f23835e6dbb8","openFiles":["48a4b4d6-c751-4efe-afe4-921eb254a535","c1737e82-f2d7-4d78-83b9-5332ec5c6efd"],"currentFileId":"48a4b4d6-c751-4efe-afe4-921eb254a535","resources":{"apigusEast1hotspacesVendorAddPromopost":{"name":"apigusEast1hotspacesVendorAddPromopost","type":"API_GATEWAY","config":{"selectedRegion":"us-east-1","apiMode":1,"apiName":"hotspacesVendor","apiId":"78frpdbste","endpointType":"EDGE","rootResourceId":"tkriwheqz6","existingResources":{"/test":"7huuxb","/test2":"fu3kp8","/":"tkriwheqz6"},"resourceMode":0,"resourceName":"AddPromo","resourcePath":"/AddPromo","restMethod":"POST","proxyIntegration":false,"enableCORS":false,"stageMode":1,"stageName":"prod","stageDeploymentId":"54uq1y"},"globallyEditable":true},"ddbPromotions":{"name":"ddbPromotions","type":"DynamoDB","config":{"mode":0,"operation":"put","table":{"arn":"","name":"Promotions","partitionKey":"PromoId","partitionKeyType":"S","hasSortKey":true,"sortKey":"VendorId","sortKeyType":"S","mode":0},"parameters":{"TableName":"Promotions","Item":{"PromoId":"@{promoId}","VendorId":"@{vendorId}","OfferType":"@{offerType}","StartDate":"@{startDate}","EndDate":"@{endDate}","StartTimeSlots":"@{startTimeSlots}","EndTimeSlots":"@{endTimeSlots}","Description":"@{description}","UnitPrice":"@{unitPrice}","Title":"@{title}","ImgUrl":"@{imgUrl}"}},"validator":{"validatableFields":{},"validity":true},"valid":true},"globallyEditable":false}},"envVariables":[{"lambdaId":"all","varKey":"SIGMA_AWS_ACC_ID","varValue":null,"shouldPersist":false,"displayOnly":false,"editable":false}],"packageJSON":{"dependencies":{}},"lambdaId":"48a4b4d6-c751-4efe-afe4-921eb254a535"},"PROJECT_META":{"projectName":"HotspacesVendor","projectDescription":"","projectVersion":"1.0.0","projectRegion":"us-east-1","lastSave":1540804539124},"VCS_STATE":{"provider":"GitHub","repo":{"name":"HotspacesVendor","url":"https://github.com/TestAndunR/HotspacesVendor"}}}