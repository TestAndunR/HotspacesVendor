{"EDITOR_STATE":{"allProjectFiles":{"dad2d1f5-2c20-4e8d-b5af-f23835e6dbb8":{"id":"dad2d1f5-2c20-4e8d-b5af-f23835e6dbb8","parent":null,"name":"HotspacesVendor","type":"DIRECTORY","isDirectory":true,"children":["48a4b4d6-c751-4efe-afe4-921eb254a535","c1737e82-f2d7-4d78-83b9-5332ec5c6efd","b9b3322c-b75d-4484-93c2-c7083fe20a8d"],"isRemovable":false,"filePath":"HotspacesVendor"},"48a4b4d6-c751-4efe-afe4-921eb254a535":{"id":"48a4b4d6-c751-4efe-afe4-921eb254a535","parent":"dad2d1f5-2c20-4e8d-b5af-f23835e6dbb8","name":"lambda.js","type":"LAMBDA_FILE","isDirectory":false,"children":[],"isRemovable":true,"filePath":"HotspacesVendor/lambda.js","code":"let AWS = require('aws-sdk');\nconst ddb = new AWS.DynamoDB.DocumentClient();\nconst uuidv4 = require('uuid/v4');\n\nexports.handler = function (event, context, callback) {\n    console.log(event);\n    let body = JSON.parse(event.body);\n    let promoId = uuidv4();\n    let vendorId = body.vendorId;\n    let offerType = body.offerType;\n    let discount = body.discount;\n    let startDate = body.startDate;\n    let endDate = body.endDate;\n    let startTimeSlots = body.startTimeSlots;\n    let endTimeSlots = body.endTimeSlots;\n    let description = body.description;\n    let title = body.title;\n    let unitPrice = body.unitPrice;\n    let imgUrl = body.imgUrl;\n\n    ddb.put({\n        TableName: 'Promotions',\n        Item: {\n            'PromoId': promoId,\n            'VendorId': vendorId,\n            'OfferType': offerType,\n            'StartDate': startDate,\n            'EndDate': endDate,\n            'StartTimeSlots': startTimeSlots,\n            'EndTimeSlots': endTimeSlots,\n            'Description': description,\n            'UnitPrice': unitPrice,\n            'Title': title,\n            'ImgUrl': imgUrl,\n            'Discount': discount\n        }\n    }).promise().then(function (data) {\n        callback(null, {\n            \"isBase64Encoded\": true,\n            \"statusCode\": 200,\n            \"headers\": {\n                \"Access-Control-Allow-Origin\": \"*\",\n                \"Access-Control-Allow-Methods\": \"*\"\n            },\n            \"body\": 'Successfully added promotion'\n        });\n        // console.log(\"Success \" + data)\n        //your logic goes here\n    }).catch(function (err) {\n        //handle error\n        console.log(\"Error\" + err)\n        callback(null, {\n            \"isBase64Encoded\": true,\n            \"statusCode\": 502,\n            \"headers\": {\n                \"Access-Control-Allow-Origin\": \"*\",\n                \"Access-Control-Allow-Methods\": \"*\"\n            },\n            \"body\": 'Adding promotion to dynamoDB failed ' + error.message\n        });\n    });\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","triggers":[{"resourceName":"apigusEast1addUserpromopost","config":{}}],"config":{"memory":128,"timeout":60,"runtime":"nodejs8.10"},"testCases":{"ace35fde-eba1-446d-b586-4954b6edfe94":{"id":"ace35fde-eba1-446d-b586-4954b6edfe94","name":"Unnamed event","functionId":"48a4b4d6-c751-4efe-afe4-921eb254a535","event":"{\n    \"sasa\":\"ssdsd\"\n}"}}},"c1737e82-f2d7-4d78-83b9-5332ec5c6efd":{"id":"c1737e82-f2d7-4d78-83b9-5332ec5c6efd","parent":"dad2d1f5-2c20-4e8d-b5af-f23835e6dbb8","name":"dynamoDbService.js","type":"JS_FILE","isDirectory":false,"children":[],"isRemovable":true,"filePath":"HotspacesVendor/dynamoDbService.js","code":"// let AWS = require('aws-sdk');\n// const ddb = new AWS.DynamoDB.DocumentClient();\n// const uuidv4 = require('uuid/v4');\n\n// module.exports = {\n  \n//     addPromo: function (promoData) {\n//         // let prmoId = uuidv4(); \n//         let promoId = promoData.promoId;\n//         // let vendorId = promoData.vendorId;\n//         // let offerType = promoData.offerType;\n//         // let startDate = promoData.startDate;\n//         // let endDate = promoData.endDate;\n//         // let startTimeSlots = promoData.startTimeSlots;\n//         // let endTimeSlots = promoData.endTimeSlots;\n//         // let description = promoData.description;\n//         // let title = promoData.title;\n//         // let unitPrice = promoData.unitPrice;\n//         // let imgUrl = promoData.imgUrl;\n//         return ddb.put({\n//             TableName: 'HS_promotions',\n//             Item: {\n//                 'PromoId': promoId,\n//                 // 'VendorId': vendorId,\n//                 // 'OfferType': offerType,\n//                 // 'StartDate': startDate,\n//                 // 'EndDate': endDate,\n//                 // 'StartTimeSlots': startTimeSlots,\n//                 // 'EndTimeSlots': endTimeSlots,\n//                 // 'Description': description,\n//                 // 'UnitPrice': unitPrice,\n//                 // 'Title': title,\n//                 // 'ImgUrl': imgUrl\n//             }\n//         });\n//     },\n\n    \n// }","triggers":[]},"b9b3322c-b75d-4484-93c2-c7083fe20a8d":{"id":"b9b3322c-b75d-4484-93c2-c7083fe20a8d","parent":"dad2d1f5-2c20-4e8d-b5af-f23835e6dbb8","name":"getPromo.js","type":"LAMBDA_FILE","isDirectory":false,"children":[],"isRemovable":true,"filePath":"HotspacesVendor/getPromo.js","code":"let AWS = require('aws-sdk');\nconst ddb = new AWS.DynamoDB.DocumentClient();\n\nexports.handler = function (event, context, callback) {\n    let body = JSON.parse(event.body);\n    let vendor = body.vendorId;\n    ddb.scan({\n        TableName: 'Promotions',\n        ExpressionAttributeValues: {\n            ':vendor': vendor\n        },\n        FilterExpression: 'VendorId = :vendor'\n    }).promise().then(function (data) {\n        callback(null, {\n            \"isBase64Encoded\": true,\n            \"statusCode\": 200,\n            \"headers\": {\n                \"Access-Control-Allow-Origin\": \"*\",\n                \"Access-Control-Allow-Methods\": \"*\"\n            },\n            \"body\": JSON.stringify(data.Items)\n        });\n    }).catch(function (err) {\n        //handle error\n        // console.log(err);\n        callback(null, {\n            \"isBase64Encoded\": true,\n            \"statusCode\": 502,\n            \"headers\": {\n                \"Access-Control-Allow-Origin\": \"*\",\n                \"Access-Control-Allow-Methods\": \"*\"\n            },\n            \"body\": 'Error occured in scanning ' + error.message\n        });\n    });\n    // console.log(event);\n    // callback(null, 'Successfully executed');\n}","triggers":[{"resourceName":"apigusEast1addUserpromoget","config":{}}],"config":{"memory":128,"timeout":60,"runtime":"nodejs8.10"},"testCases":{"5aeac0cf-f98f-493d-b393-d3ae56f36768":{"id":"5aeac0cf-f98f-493d-b393-d3ae56f36768","name":"Unnamed event","functionId":"b9b3322c-b75d-4484-93c2-c7083fe20a8d","event":"{\n    \"key1\": \"value1\",\n    \"key2\": \"value2\",\n    \"key3\": \"value3\"\n}"}}}},"deletedFiles":[],"rootNode":"dad2d1f5-2c20-4e8d-b5af-f23835e6dbb8","openFiles":["48a4b4d6-c751-4efe-afe4-921eb254a535","b9b3322c-b75d-4484-93c2-c7083fe20a8d"],"currentFileId":"b9b3322c-b75d-4484-93c2-c7083fe20a8d","resources":{"ddbPromotions":{"name":"ddbPromotions","type":"DynamoDB","config":{"mode":0,"operation":"scan","table":{"arn":"","name":"Promotions","partitionKey":"PromoId","partitionKeyType":"S","hasSortKey":true,"sortKey":"VendorId","sortKeyType":"S","mode":0},"parameters":{"TableName":"Promotions","ExpressionAttributeValues":{":vendorID":"@{vendor}"},"FilterExpression":"vendorId = :"},"validator":{"validatableFields":{},"validity":true},"valid":true},"globallyEditable":false},"apigusEast1addUserpromopost":{"name":"apigusEast1addUserpromopost","type":"API_GATEWAY","config":{"selectedRegion":"us-east-1","apiMode":1,"apiName":"addUser","apiId":"xc49jdvxwe","endpointType":"EDGE","rootResourceId":"abft45wa04","existingResources":{"/qr":"464kbc","/":"abft45wa04","/vendor/list":"ld82px","/vendor":"nyuvaj","/user":"topael"},"resourceMode":0,"resourceName":"promo","resourcePath":"/promo","restMethod":"POST","proxyIntegration":false,"enableCORS":false,"stageMode":1,"stageName":"prod","stageDeploymentId":"s05w0l"},"globallyEditable":true},"apigusEast1addUserpromoget":{"name":"apigusEast1addUserpromoget","type":"API_GATEWAY","config":{"selectedRegion":"us-east-1","apiMode":1,"apiName":"addUser","apiId":"xc49jdvxwe","endpointType":"EDGE","rootResourceId":"abft45wa04","existingResources":{"/qr":"464kbc","/":"abft45wa04","/vendor/list":"ld82px","/vendor":"nyuvaj","/user":"topael","/promo":"vvdqxa"},"resourceMode":0,"resourceName":"promo","resourcePath":"/promo","restMethod":"GET","proxyIntegration":true,"enableCORS":true,"stageMode":1,"stageName":"prod","stageDeploymentId":"0slszk"},"globallyEditable":true}},"envVariables":[{"lambdaId":"all","varKey":"SIGMA_AWS_ACC_ID","varValue":null,"shouldPersist":false,"displayOnly":false,"editable":false}],"packageJSON":{"dependencies":{"uuid":{"name":"uuid","version":"3.3.2"}}},"lambdaId":"48a4b4d6-c751-4efe-afe4-921eb254a535"},"PROJECT_META":{"projectName":"HotspacesVendor","projectDescription":"","projectVersion":"1.0.0","projectRegion":"us-east-1","lastSave":1540962829960},"VCS_STATE":{"provider":"GitHub","repo":{"name":"HotspacesVendor","url":"https://github.com/TestAndunR/HotspacesVendor"}}}